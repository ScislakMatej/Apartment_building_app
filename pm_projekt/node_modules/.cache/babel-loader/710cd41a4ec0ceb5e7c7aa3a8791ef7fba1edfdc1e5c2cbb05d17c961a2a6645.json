{"ast":null,"code":"var _jsxFileName = \"/Users/matejscislak/Desktop/4roc_ZS/PM/apka/ProjektManazment/pm_projekt/src/VotingBox.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\"; // Add axios for making HTTP requests\nimport \"./VotingBox.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction VotingBox({\n  votes,\n  toggleVoteModal,\n  setVotes\n}) {\n  _s();\n  const [expandedVoteIndex, setExpandedVoteIndex] = useState(null);\n  const [voteCounts, setVoteCounts] = useState([]);\n  const [userVotes, setUserVotes] = useState({});\n  const [showAllVotes, setShowAllVotes] = useState(false);\n  const getUserFromLocalStorage = () => {\n    try {\n      const user = localStorage.getItem(\"user\");\n      return user ? JSON.parse(user) : null;\n    } catch (error) {\n      return null;\n    }\n  };\n  const isAuthenticated = () => {\n    const user = getUserFromLocalStorage();\n    return user && user.meno && user.priezvisko;\n  };\n  useEffect(() => {\n    if (!isAuthenticated()) {\n      return;\n    }\n\n    // Fetch the votes from the database\n    axios.get(\"/api/votes\").then(response => {\n      setVotes(response.data);\n    }).catch(error => {\n      console.error('Error fetching votes:', error);\n    });\n  }, []);\n  const handleVote = (voteIndex, answerIndex) => {\n    if (!isAuthenticated()) {\n      alert(\"You must be logged in to vote.\");\n      return;\n    }\n    const user = getUserFromLocalStorage();\n    axios.post(\"/api/vote\", {\n      voteId: votes[voteIndex].id,\n      answer: answerIndex\n    }).then(response => {\n      setVotes(prevVotes => {\n        const updatedVotes = [...prevVotes];\n        updatedVotes[voteIndex].pocet_hlasov += 1;\n        return updatedVotes;\n      });\n      alert(\"Vote successfully cast\");\n    }).catch(error => {\n      alert(\"Error casting vote\");\n      console.error(error);\n    });\n  };\n  const handleRemoveVote = voteIndex => {\n    if (!isAuthenticated()) {\n      alert(\"You must be logged in to remove your vote.\");\n      return;\n    }\n    const user = getUserFromLocalStorage();\n    axios.post(\"/api/removeVote\", {\n      voteId: votes[voteIndex].id\n    }).then(response => {\n      setVotes(prevVotes => {\n        const updatedVotes = [...prevVotes];\n        updatedVotes[voteIndex].pocet_hlasov -= 1;\n        return updatedVotes;\n      });\n      alert(\"Vote successfully removed\");\n    }).catch(error => {\n      alert(\"Error removing vote\");\n      console.error(error);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"voting-box\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"voting-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Posledn\\xE9 hlasovanie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"list-btn\",\n        onClick: () => setShowAllVotes(!showAllVotes),\n        children: showAllVotes ? \"Skryť všetky možnosti\" : \"Zobraziť všetky možnosti\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vote-options\",\n      children: votes.slice(0, showAllVotes ? votes.length : 5).map((vote, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vote-option\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vote-option-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: vote.nazov\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: vote.popis\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vote-answers\",\n          children: vote.moznosti.map((answer, answerIndex) => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleVote(index, answerIndex),\n            className: \"vote-answer-btn\",\n            children: answer\n          }, answerIndex, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [vote.pocet_hlasov, \" hlasov\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }, this)]\n      }, vote.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n_s(VotingBox, \"ofqoRNeoYjwYuCC5IPKx3SS55VU=\");\n_c = VotingBox;\nexport default VotingBox;\nvar _c;\n$RefreshReg$(_c, \"VotingBox\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","VotingBox","votes","toggleVoteModal","setVotes","_s","expandedVoteIndex","setExpandedVoteIndex","voteCounts","setVoteCounts","userVotes","setUserVotes","showAllVotes","setShowAllVotes","getUserFromLocalStorage","user","localStorage","getItem","JSON","parse","error","isAuthenticated","meno","priezvisko","get","then","response","data","catch","console","handleVote","voteIndex","answerIndex","alert","post","voteId","id","answer","prevVotes","updatedVotes","pocet_hlasov","handleRemoveVote","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","slice","length","map","vote","index","nazov","popis","moznosti","_c","$RefreshReg$"],"sources":["/Users/matejscislak/Desktop/4roc_ZS/PM/apka/ProjektManazment/pm_projekt/src/VotingBox.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\"; // Add axios for making HTTP requests\nimport \"./VotingBox.css\";\n\nfunction VotingBox({ votes, toggleVoteModal, setVotes }) {\n  const [expandedVoteIndex, setExpandedVoteIndex] = useState(null);\n  const [voteCounts, setVoteCounts] = useState([]);\n  const [userVotes, setUserVotes] = useState({});\n  const [showAllVotes, setShowAllVotes] = useState(false);\n\n  const getUserFromLocalStorage = () => {\n    try {\n      const user = localStorage.getItem(\"user\");\n      return user ? JSON.parse(user) : null;\n    } catch (error) {\n      return null;\n    }\n  };\n\n  const isAuthenticated = () => {\n    const user = getUserFromLocalStorage();\n    return user && user.meno && user.priezvisko;\n  };\n\n  useEffect(() => {\n    if (!isAuthenticated()) {\n      return;\n    }\n\n    // Fetch the votes from the database\n    axios.get(\"/api/votes\")\n      .then(response => {\n        setVotes(response.data);\n      })\n      .catch(error => {\n        console.error('Error fetching votes:', error);\n      });\n  }, []);\n\n  const handleVote = (voteIndex, answerIndex) => {\n    if (!isAuthenticated()) {\n      alert(\"You must be logged in to vote.\");\n      return;\n    }\n\n    const user = getUserFromLocalStorage();\n    axios.post(\"/api/vote\", {\n      voteId: votes[voteIndex].id,\n      answer: answerIndex\n    })\n      .then(response => {\n        setVotes(prevVotes => {\n          const updatedVotes = [...prevVotes];\n          updatedVotes[voteIndex].pocet_hlasov += 1;\n          return updatedVotes;\n        });\n        alert(\"Vote successfully cast\");\n      })\n      .catch(error => {\n        alert(\"Error casting vote\");\n        console.error(error);\n      });\n  };\n\n  const handleRemoveVote = (voteIndex) => {\n    if (!isAuthenticated()) {\n      alert(\"You must be logged in to remove your vote.\");\n      return;\n    }\n\n    const user = getUserFromLocalStorage();\n    axios.post(\"/api/removeVote\", { voteId: votes[voteIndex].id })\n      .then(response => {\n        setVotes(prevVotes => {\n          const updatedVotes = [...prevVotes];\n          updatedVotes[voteIndex].pocet_hlasov -= 1;\n          return updatedVotes;\n        });\n        alert(\"Vote successfully removed\");\n      })\n      .catch(error => {\n        alert(\"Error removing vote\");\n        console.error(error);\n      });\n  };\n\n  return (\n    <div className=\"voting-box\">\n      <div className=\"voting-header\">\n        <h3>Posledné hlasovanie</h3>\n        <button className=\"list-btn\" onClick={() => setShowAllVotes(!showAllVotes)}>\n          {showAllVotes ? \"Skryť všetky možnosti\" : \"Zobraziť všetky možnosti\"}\n        </button>\n      </div>\n\n      <div className=\"vote-options\">\n        {votes.slice(0, showAllVotes ? votes.length : 5).map((vote, index) => (\n          <div key={vote.id} className=\"vote-option\">\n            <div className=\"vote-option-header\">\n              <h4>{vote.nazov}</h4>\n              <p>{vote.popis}</p>\n            </div>\n            <div className=\"vote-answers\">\n              {vote.moznosti.map((answer, answerIndex) => (\n                <button\n                  key={answerIndex}\n                  onClick={() => handleVote(index, answerIndex)}\n                  className=\"vote-answer-btn\"\n                >\n                  {answer}\n                </button>\n              ))}\n            </div>\n            <p>{vote.pocet_hlasov} hlasov</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default VotingBox;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}